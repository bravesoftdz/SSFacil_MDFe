unit UDMEnvio;

interface

uses
  SysUtils, Classes, FMTBcd, DB, DBClient, Provider, SqlExpr, frxClass,
  frxDBSet, frxRich, frxExportMail, frxExportPDF, frxBarcode;

type
  TDMEnvio = class(TDataModule)
    sdsMDFe: TSQLDataSet;
    dspMDFe: TDataSetProvider;
    cdsMDFe: TClientDataSet;
    dsMDFe: TDataSource;
    cdsMDFeID: TIntegerField;
    cdsMDFeTIPO_AMBIENTE: TStringField;
    cdsMDFeTIPO_EMITENTE: TStringField;
    cdsMDFeTIPO_TRANSPORTADOR: TStringField;
    cdsMDFeSERIE: TStringField;
    cdsMDFeNUM_MANIFESTO: TIntegerField;
    cdsMDFeMODALIDADE_TRANSP: TStringField;
    cdsMDFeDTEMISSAO: TDateField;
    cdsMDFeHREMISSAO: TTimeField;
    cdsMDFeFORMA_EMISSAO: TStringField;
    cdsMDFeTIPO_EMISSAO: TStringField;
    cdsMDFeVERSAO_EMISSAO: TStringField;
    cdsMDFeUF_CARREGAMENTO: TStringField;
    cdsMDFeUF_DESCARREGAMENTO: TStringField;
    cdsMDFeCHAVE_ACESSO: TStringField;
    cdsMDFeQTD_NFE: TIntegerField;
    cdsMDFeQTD_MDFE: TIntegerField;
    cdsMDFeVLR_TOTAL: TFloatField;
    cdsMDFeUNIDADE_PESO: TStringField;
    cdsMDFePESO_BRUTO: TFloatField;
    cdsMDFeINF_FISCO: TMemoField;
    cdsMDFeINF_ADICIONAIS: TMemoField;
    cdsMDFeFILIAL: TIntegerField;
    cdsMDFeID_VEICULO: TIntegerField;
    cdsMDFeCOD_AG_PORTO: TStringField;
    cdsMDFeRNTRC: TStringField;
    cdsMDFeDTINICIO: TDateField;
    cdsMDFeHRINICIO: TTimeField;
    cdsMDFePROTOCOLO_MDFE: TStringField;
    cdsMDFePLACA: TStringField;
    cdsMDFeUF_PLACA: TStringField;
    cdsMDFeRENAVAM: TStringField;
    cdsMDFeTARA_KG: TFloatField;
    cdsMDFeCAPACIDADE_KG: TFloatField;
    cdsMDFeCAPACIDADE_M3: TFloatField;
    cdsMDFeID_PROPRIETARIO: TIntegerField;
    cdsMDFeNOME_PROPRIETARIO: TStringField;
    cdsMDFeCNPJ_CPF_PROPRIETARIO: TStringField;
    cdsMDFeINSC_ESTADUAL_PROPRIETARIO: TStringField;
    cdsMDFeUF_PROPRIETARIO: TStringField;
    cdsMDFeTIPO_REG_PROPRIETARIO: TStringField;
    cdsMDFeRNTRC_PROPRIETARIO: TStringField;
    cdsMDFePESSOA_PROPRIETARIO: TStringField;
    cdsMDFeNOME_FILIAL: TStringField;
    cdsMDFeCNPJ_CPF_FILIAL: TStringField;
    cdsMDFeINSC_ESTADUAL_FILIAL: TStringField;
    cdsMDFeFANTASIA_FILIAL: TStringField;
    cdsMDFeEND_FILIAL: TStringField;
    cdsMDFeBAIRRO_FILIAL: TStringField;
    cdsMDFeCEP_FILIAL: TStringField;
    cdsMDFeNUM_END_FILIAL: TStringField;
    cdsMDFeUF_FILIAL: TStringField;
    cdsMDFeDDD_FILIAL: TIntegerField;
    cdsMDFeFONE_FILIAL: TStringField;
    cdsMDFeCIDADE_FILIAL: TStringField;
    cdsMDFeCODMUNICIPIO_FILIAL: TStringField;
    cdsMDFeCODUF_FILIAL: TStringField;
    sdsMDFe_Cidade_Car: TSQLDataSet;
    sdsMDFe_Cidade_CarID: TIntegerField;
    sdsMDFe_Cidade_CarITEM: TIntegerField;
    sdsMDFe_Cidade_CarID_CIDADE: TIntegerField;
    sdsMDFe_Cidade_CarCIDADE: TStringField;
    cdsMDFe_Cidade_Car: TClientDataSet;
    cdsMDFe_Cidade_CarID: TIntegerField;
    cdsMDFe_Cidade_CarITEM: TIntegerField;
    cdsMDFe_Cidade_CarID_CIDADE: TIntegerField;
    cdsMDFe_Cidade_CarCIDADE: TStringField;
    dsMDFe_Cidade_Car: TDataSource;
    sdsMDFe_Mestre: TDataSource;
    sdsMDFe_Cidade_CarCODMUNICIPIO: TStringField;
    cdsMDFesdsMDFe_Cidade_Car: TDataSetField;
    cdsMDFe_Cidade_CarCODMUNICIPIO: TStringField;
    sdsMDFe_Cidade_CarNOME_CIDADE: TStringField;
    cdsMDFe_Cidade_CarNOME_CIDADE: TStringField;
    cdsMDFeCOMPLEMENTO_END_FILIAL: TStringField;
    cdsMDFeEMAIL_NFE: TStringField;
    sdsMDFe_Condutor: TSQLDataSet;
    sdsMDFe_CondutorID: TIntegerField;
    sdsMDFe_CondutorITEM: TIntegerField;
    sdsMDFe_CondutorNOME: TStringField;
    sdsMDFe_CondutorCPF: TStringField;
    sdsMDFe_CondutorID_CONDUTOR: TIntegerField;
    cdsMDFe_Condutor: TClientDataSet;
    cdsMDFe_CondutorID: TIntegerField;
    cdsMDFe_CondutorITEM: TIntegerField;
    cdsMDFe_CondutorNOME: TStringField;
    cdsMDFe_CondutorCPF: TStringField;
    cdsMDFe_CondutorID_CONDUTOR: TIntegerField;
    dsMDFe_Condutor: TDataSource;
    cdsMDFesdsMDFe_Condutor: TDataSetField;
    cdsMDFeTIPO_RODADO: TStringField;
    cdsMDFeTIPO_CARROCERIA: TStringField;
    qParametros_MDFe: TSQLQuery;
    qParametros_MDFeVERSAO_EMISSAO: TStringField;
    qParametros_MDFeVERSAO_LEIAUTE: TStringField;
    qParametros_MDFeVERSAO_MODAL: TStringField;
    cdsMDFesdsMDFe_Cidade_Des: TDataSetField;
    sdsMDFe_Lacre: TSQLDataSet;
    sdsMDFe_LacreID: TIntegerField;
    sdsMDFe_LacreITEM: TIntegerField;
    sdsMDFe_LacreNUM_LACRE: TStringField;
    sdsMDFe_LacreTIPO: TStringField;
    cdsMDFe_Lacre: TClientDataSet;
    cdsMDFe_LacreID: TIntegerField;
    cdsMDFe_LacreITEM: TIntegerField;
    cdsMDFe_LacreNUM_LACRE: TStringField;
    cdsMDFe_LacreTIPO: TStringField;
    dsMDFe_Lacre: TDataSource;
    cdsMDFesdsMDFe_Lacre: TDataSetField;
    sdsMDFe_AutXML: TSQLDataSet;
    sdsMDFe_AutXMLID: TIntegerField;
    sdsMDFe_AutXMLITEM: TIntegerField;
    sdsMDFe_AutXMLPESSOA: TStringField;
    sdsMDFe_AutXMLCNPJ_CPF: TStringField;
    cdsMDFe_AutXML: TClientDataSet;
    cdsMDFe_AutXMLID: TIntegerField;
    cdsMDFe_AutXMLITEM: TIntegerField;
    cdsMDFe_AutXMLPESSOA: TStringField;
    cdsMDFe_AutXMLCNPJ_CPF: TStringField;
    dsMDFe_AutXML: TDataSource;
    cdsMDFesdsMDFe_AutXML: TDataSetField;
    sdsMDFe_Reboque: TSQLDataSet;
    sdsMDFe_ReboqueID: TIntegerField;
    sdsMDFe_ReboqueITEM: TIntegerField;
    sdsMDFe_ReboqueID_VEICULO: TIntegerField;
    cdsMDFe_Reboque: TClientDataSet;
    cdsMDFe_ReboqueID: TIntegerField;
    cdsMDFe_ReboqueITEM: TIntegerField;
    cdsMDFe_ReboqueID_VEICULO: TIntegerField;
    dsMDFe_Reboque: TDataSource;
    sdsMDFe_ReboqueNOME_VEICULO: TStringField;
    sdsMDFe_ReboquePLACA: TStringField;
    sdsMDFe_ReboqueUF_PLACA: TStringField;
    sdsMDFe_ReboqueRENAVAM: TStringField;
    sdsMDFe_ReboqueTARA_KG: TFloatField;
    sdsMDFe_ReboqueCAPACIDADE_KG: TFloatField;
    sdsMDFe_ReboqueCAPACIDADE_M3: TFloatField;
    sdsMDFe_ReboqueID_PROPRIETARIO: TIntegerField;
    sdsMDFe_ReboqueTIPO_RODADO: TStringField;
    sdsMDFe_ReboqueTIPO_CARROCERIA: TStringField;
    cdsMDFesdsMDFe_Reboque: TDataSetField;
    cdsMDFe_ReboqueNOME_VEICULO: TStringField;
    cdsMDFe_ReboquePLACA: TStringField;
    cdsMDFe_ReboqueUF_PLACA: TStringField;
    cdsMDFe_ReboqueRENAVAM: TStringField;
    cdsMDFe_ReboqueTARA_KG: TFloatField;
    cdsMDFe_ReboqueCAPACIDADE_KG: TFloatField;
    cdsMDFe_ReboqueCAPACIDADE_M3: TFloatField;
    cdsMDFe_ReboqueID_PROPRIETARIO: TIntegerField;
    cdsMDFe_ReboqueTIPO_RODADO: TStringField;
    cdsMDFe_ReboqueTIPO_CARROCERIA: TStringField;
    sdsMDFe_ReboqueNOME_PROPRIETARIO: TStringField;
    sdsMDFe_ReboqueCNPJ_CPF_PROPRIETARIO: TStringField;
    sdsMDFe_ReboqueINSC_ESTADUAL_PROPRIETARIO: TStringField;
    sdsMDFe_ReboqueUF_PROPRIETARIO: TStringField;
    sdsMDFe_ReboqueTIPO_REG_PROPRIETARIO: TStringField;
    sdsMDFe_ReboqueRNTRC_PROPRIETARIO: TStringField;
    sdsMDFe_ReboquePESSOA_PROPRIETARIO: TStringField;
    cdsMDFe_ReboqueNOME_PROPRIETARIO: TStringField;
    cdsMDFe_ReboqueCNPJ_CPF_PROPRIETARIO: TStringField;
    cdsMDFe_ReboqueINSC_ESTADUAL_PROPRIETARIO: TStringField;
    cdsMDFe_ReboqueUF_PROPRIETARIO: TStringField;
    cdsMDFe_ReboqueTIPO_REG_PROPRIETARIO: TStringField;
    cdsMDFe_ReboqueRNTRC_PROPRIETARIO: TStringField;
    cdsMDFe_ReboquePESSOA_PROPRIETARIO: TStringField;
    sdsMDFe_Percurso: TSQLDataSet;
    sdsMDFe_PercursoID: TIntegerField;
    sdsMDFe_PercursoITEM: TIntegerField;
    sdsMDFe_PercursoUF: TStringField;
    cdsMDFe_Percurso: TClientDataSet;
    cdsMDFe_PercursoID: TIntegerField;
    cdsMDFe_PercursoITEM: TIntegerField;
    cdsMDFe_PercursoUF: TStringField;
    dsMDFe_Percurso: TDataSource;
    cdsMDFesdsMDFe_Percurso: TDataSetField;
    qParametros: TSQLQuery;
    qParametrosLOCALSERVIDORNFE: TStringField;
    qParametrosFUSOHORARIO_VERAO: TStringField;
    qParametrosFUSOHORARIO: TStringField;
    qFilial: TSQLQuery;
    qFilialID: TIntegerField;
    qFilialNOME: TStringField;
    qFilialLOCALSERVIDORNFE: TStringField;
    sdsMDFe_Averbacao: TSQLDataSet;
    sdsMDFe_AverbacaoID: TIntegerField;
    sdsMDFe_AverbacaoITEM: TIntegerField;
    sdsMDFe_AverbacaoNUM_AVERBACAO: TStringField;
    cdsMDFe_Averbacao: TClientDataSet;
    cdsMDFe_AverbacaoID: TIntegerField;
    cdsMDFe_AverbacaoITEM: TIntegerField;
    cdsMDFe_AverbacaoNUM_AVERBACAO: TStringField;
    dsMDFe_Averbacao: TDataSource;
    sdsMDFe_Seguradora: TSQLDataSet;
    sdsMDFe_SeguradoraID: TIntegerField;
    sdsMDFe_SeguradoraITEM: TIntegerField;
    sdsMDFe_SeguradoraRESPONSAVEL_SEGURO: TStringField;
    sdsMDFe_SeguradoraPESSOA_RESP_SEG: TStringField;
    sdsMDFe_SeguradoraCNPJ_CPF_RESP_SEG: TStringField;
    sdsMDFe_SeguradoraID_SEGURADORA: TIntegerField;
    sdsMDFe_SeguradoraNUM_APOLICE: TIntegerField;
    cdsMDFe_Seguradora: TClientDataSet;
    cdsMDFe_SeguradoraID: TIntegerField;
    cdsMDFe_SeguradoraITEM: TIntegerField;
    cdsMDFe_SeguradoraRESPONSAVEL_SEGURO: TStringField;
    cdsMDFe_SeguradoraPESSOA_RESP_SEG: TStringField;
    cdsMDFe_SeguradoraCNPJ_CPF_RESP_SEG: TStringField;
    cdsMDFe_SeguradoraID_SEGURADORA: TIntegerField;
    cdsMDFe_SeguradoraNUM_APOLICE: TIntegerField;
    dsMDFe_Seguradora: TDataSource;
    dsMDFe_Seguradora_Mestre: TDataSource;
    sdsMDFe_SeguradoraNOME_SEGURADORA: TStringField;
    sdsMDFe_SeguradoraCNPJ_SEGURADORA: TStringField;
    cdsMDFesdsMDFe_Seguradora: TDataSetField;
    cdsMDFe_SeguradoraNOME_SEGURADORA: TStringField;
    cdsMDFe_SeguradoraCNPJ_SEGURADORA: TStringField;
    cdsMDFe_SeguradorasdsMDFe_Averbacao: TDataSetField;
    sdsMDFe_Cidade_Des: TSQLDataSet;
    sdsMDFe_Cidade_DesID: TIntegerField;
    sdsMDFe_Cidade_DesITEM: TIntegerField;
    sdsMDFe_Cidade_DesID_CIDADE: TIntegerField;
    sdsMDFe_Cidade_DesCIDADE: TStringField;
    cdsMDFe_Cidade_Des: TClientDataSet;
    cdsMDFe_Cidade_DesID: TIntegerField;
    cdsMDFe_Cidade_DesITEM: TIntegerField;
    cdsMDFe_Cidade_DesID_CIDADE: TIntegerField;
    cdsMDFe_Cidade_DesCIDADE: TStringField;
    cdsMDFe_Cidade_DessdsMDFe_NFe: TDataSetField;
    dsMDFe_Cidade_Des: TDataSource;
    sdsMDFe_NFe: TSQLDataSet;
    sdsMDFe_NFeID: TIntegerField;
    sdsMDFe_NFeITEM: TIntegerField;
    sdsMDFe_NFeITEM_NFE: TIntegerField;
    sdsMDFe_NFeCHAVE_ACESSO: TStringField;
    sdsMDFe_NFeINDICADOR_REENTREGA: TStringField;
    cdsMDFe_NFe: TClientDataSet;
    cdsMDFe_NFeID: TIntegerField;
    cdsMDFe_NFeITEM: TIntegerField;
    cdsMDFe_NFeITEM_NFE: TIntegerField;
    cdsMDFe_NFeCHAVE_ACESSO: TStringField;
    cdsMDFe_NFeINDICADOR_REENTREGA: TStringField;
    cdsMDFe_NFeclNumNota: TIntegerField;
    cdsMDFe_NFeclSerie: TStringField;
    cdsMDFe_NFeclDtEmissao: TDateField;
    cdsMDFe_NFeclNomeCliente: TStringField;
    cdsMDFe_NFeclCidade: TStringField;
    dsMDFe_NFe: TDataSource;
    dsMDFe_Cidade_Des_Mestre: TDataSource;
    cdsMDFeXML_ASSINADO: TMemoField;
    cdsMDFeXML_ASSINADO_PROC: TMemoField;
    cdsMDFeRECIBO_MDFE: TStringField;
    cdsMDFeDTENCERRAMENTO: TDateField;
    cdsMDFePROTOCOLO_ENC: TStringField;
    cdsMDFeXML_ENCERRAMENTO: TMemoField;
    cdsMDFeXML_CANCELADO: TMemoField;
    cdsMDFePROTOCOLO_CANC: TStringField;
    cdsMDFeDTCANCELAMENTO: TDateField;
    cdsMDFeDTRECIBO: TStringField;
    sdsMDFe_Cidade_DesCODMUNICIPIO: TStringField;
    cdsMDFe_Cidade_DesCODMUNICIPIO: TStringField;
    sdsMDFe_Cidade_DesNOME_CIDADE: TStringField;
    cdsMDFe_Cidade_DesNOME_CIDADE: TStringField;
    sdsMDFe_Pedagio: TSQLDataSet;
    sdsMDFe_PedagioID: TIntegerField;
    sdsMDFe_PedagioITEM: TIntegerField;
    sdsMDFe_PedagioCNPJ: TStringField;
    sdsMDFe_PedagioPESSOA_PAG: TStringField;
    sdsMDFe_PedagioCNPJ_CPF_PAG: TStringField;
    sdsMDFe_PedagioNUM_COMPROVANTE: TStringField;
    sdsMDFe_PedagioVLR_PEDAGIO: TFloatField;
    cdsMDFe_Pedagio: TClientDataSet;
    cdsMDFe_PedagioID: TIntegerField;
    cdsMDFe_PedagioITEM: TIntegerField;
    cdsMDFe_PedagioCNPJ: TStringField;
    cdsMDFe_PedagioPESSOA_PAG: TStringField;
    cdsMDFe_PedagioCNPJ_CPF_PAG: TStringField;
    cdsMDFe_PedagioNUM_COMPROVANTE: TStringField;
    cdsMDFe_PedagioVLR_PEDAGIO: TFloatField;
    dsMDFe_Pedagio: TDataSource;
    cdsMDFeDTPROTOCOLO_MDFE: TStringField;
    cdsMDFeDTPROTOCOLO_ENC: TStringField;
    cdsMDFeDTPROTOCOLO_CANC: TStringField;
    cdsMDFesdsMDFe_Pedagio: TDataSetField;
    frxReport1: TfrxReport;
    frxPDFExport1: TfrxPDFExport;
    frxMailExport1: TfrxMailExport;
    frxRichObject1: TfrxRichObject;
    frxMDFe: TfrxDBDataset;
    mAuxMDFe: TClientDataSet;
    mAuxMDFeCPF_Condutor1: TStringField;
    mAuxMDFeCPF_Condutor2: TStringField;
    mAuxMDFeCPF_Condutor3: TStringField;
    mAuxMDFeCPF_Condutor4: TStringField;
    mAuxMDFeCPF_Condutor5: TStringField;
    mAuxMDFeNome_Condutor1: TStringField;
    mAuxMDFeNome_Condutor2: TStringField;
    mAuxMDFeNome_Condutor3: TStringField;
    mAuxMDFeNome_Condutor4: TStringField;
    mAuxMDFeNome_Condutor5: TStringField;
    mAuxMDFeCNPJ_For1: TStringField;
    mAuxMDFeCNPJ_For2: TStringField;
    mAuxMDFeCNPJ_For3: TStringField;
    mAuxMDFeCNPJ_For4: TStringField;
    mAuxMDFeCNPJ_For5: TStringField;
    mAuxMDFeCNPJ_Resp1: TStringField;
    mAuxMDFeCNPJ_Resp2: TStringField;
    mAuxMDFeCNPJ_Resp3: TStringField;
    mAuxMDFeCNPJ_Resp4: TStringField;
    mAuxMDFeCNPJ_Resp5: TStringField;
    mAuxMDFeNum_Comp1: TStringField;
    mAuxMDFeNum_Comp2: TStringField;
    mAuxMDFeNum_Comp3: TStringField;
    mAuxMDFeNum_Comp4: TStringField;
    mAuxMDFeNum_Comp5: TStringField;
    dsmAuxMDFe: TDataSource;
    frxmAuxMDFe: TfrxDBDataset;
    frxBarCodeObject1: TfrxBarCodeObject;
    cdsMDFeMOTIVO_CANC: TStringField;
    cdsMDFeCANCELADO: TStringField;
    procedure DataModuleCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  DMEnvio: TDMEnvio;

implementation

uses DmdDatabase;

{$R *.dfm}

procedure TDMEnvio.DataModuleCreate(Sender: TObject);
begin
  qParametros_MDFe.Close;
  qParametros_MDFe.Open;
  qParametros.Close;
  qParametros.Open;
end;

end.
